<!doctype html>
<html class="no-js" lang="">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Web Proyecto</title>
    <!--<script type="text/javascript">
            window.onload = function () {
                var dataLength = 0;
                var data = [];
                var data2 = [];
                var data3 = [];
                $.getJSON("data.php", function (result) {
                    console.log(result);
                    dataLength = result.length;
                    for (var i = 0; i < dataLength; i++) {
                        data.push({
                            label: (result[i].fecha),
                            y: parseFloat(result[i].temperatura)
                        });
                        data2.push({
                            label: (result[i].fecha),
                            y: parseFloat(result[i].humedad)
                        });
                        data3.push({
                            label: (result[i].fecha),
                            y: parseFloat(result[i].luz)
                        });
                    }
                    ;
                    chart.render();
                    
                });
                var chart = new CanvasJS.Chart("chart", {
                    title: {
                        text: "Datos"
                    },
                    axisX: {
                        title: "Fecha",
                    },
                    data: [{type: "column", dataPoints: data2, color: "rgba(0, 201, 255, 0.4)"},{type: "area", dataPoints: data3, color: "rgba(255, 255, 0, 0.2)"},{type: "line", dataPoints: data, color: "red"}],
                });
				
            }
        </script>-->
        
        <!-- 
            https://canvasjs.com/
        -->
        <script>
            window.onload = function () {

            var dps = [];
            var dps2 = [];
            var dps3 = [];
            var chart = new CanvasJS.Chart("chartContainer", {
                title :{
                    text: "Dynamic Data"
                },
                axisY: {
                    includeZero: false
                },      
                data: [{
                    type: "column",
                    dataPoints: dps2,
                    color: "rgba(0, 201, 255, 0.4)"
                },
                {
                    type: "area",
                    dataPoints: dps3,
                    color: "rgba(255, 255, 0, 0.2)"
                },
                {
                    type: "line",
                    dataPoints: dps,
                    color: "red"
                }]
            });

            var xVal = 0;
            var yVal = 100; 
            var updateInterval = 1000;
            var dataLength = 20; // number of dataPoints visible at any point

            var updateChart = function (count) {

                count = count || 1;

                for (var j = 0; j < count; j++) {
                    $.getJSON("data.php", function (result) {
                    dataLength = result.length;
                    for (var i = 0; i < dataLength; i++) {
                        dps.push({
                            x: new Date(result[i].fecha),
                            y: parseFloat(result[i].temperatura)
                        });
                        dps2.push({
                            x: new Date(result[i].fecha),
                            y: parseFloat(result[i].humedad)
                        });
                        dps3.push({
                            x: new Date(result[i].fecha),
                            y: parseFloat(result[i].luz)
                        });
                    }
                    ;
                    chart.render();
                    
                });
                }

                if (dps.length > dataLength) {
                    dps.shift();
                    dps2.shift();
                    dps3.shift();
                }

                chart.render();
            };

            updateChart(dataLength);
            setInterval(function(){updateChart()}, updateInterval);

            }
            </script>
    <script type="text/javascript" src="assets/script/canvasjs.min.js"></script>
    <script type="text/javascript" src="assets/script/jquery-2.2.3.min.js"></script>
</head> 
<body>
 <!--   
    <div id="chart"></div> 
  -->
    <div id="chartContainer" style="height: 370px; width:100%;"></div>
</body>
</html>